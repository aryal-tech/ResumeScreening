{% extends "base.html" %}
{% block title %}Home | Automated Resume Screening and Ranking{% endblock %}

{% block content %}

{% if not is_logged_in %}
  <!-- LOGGED-OUT: Hero -->
  <section class="hero hero-landing">
    <!-- PLACEHOLDER HERO IMAGE AREA: set --hero-img in CSS if you add a banner -->
    <div class="hero-content">
      <h1>Automated Resume Screening & Ranking</h1>
      <p class="sub">Upload a Job Description and multiple resumes to get instant, ranked matches. Save hours of manual review.</p>
      <div class="cta-row">
        <a class="btn btn-primary" href="{{ url_for('register') }}">Create Free Account</a>
        <a class="btn btn-ghost" href="{{ url_for('login') }}">Log In</a>
      </div>
      <div class="trust-strip">
        <span class="badge">PDF-Native</span>
        <span class="badge">Duplicate Detection</span>
        <span class="badge">Section-Aware Scoring</span>
      </div>
    </div>
  </section>

  <!-- How it works -->
  <section class="section">
    <h2>How it works</h2>
    <div class="steps-grid">
      <div class="step-card">
        <!-- ICON PLACEHOLDER -->
        <h3>1. Upload JD</h3>
        <p>Use a well-structured JD (headers like “Responsibilities”, “Requirements”).</p>
      </div>
      <div class="step-card">
        <h3>2. Add Resumes</h3>
        <p>Drag & drop multiple PDFs. Re-uploads are auto-flagged as duplicates.</p>
      </div>
      <div class="step-card">
        <h3>3. Get Ranked Results</h3>
        <p>We compute TF-IDF + cosine, boost JD (×1.5) & resume key terms (×2.0), then rank.</p>
      </div>
    </div>
  </section>

  <!-- Feature highlights -->
  <section class="section">
    <h2>Why teams use ResumeScreener</h2>
    <div class="cards-grid">
      <div class="card">
        <h3>JD Term Boosting</h3>
        <p>Weight “Responsibilities”, “Qualifications”, and “Skills” so the ranking matches intent.</p>
      </div>
      <div class="card">
        <h3>Noise-Free Tokens</h3>
        <p>Compound preservation (e.g., C++, .NET), synonym normalization, and curated stop-words.</p>
      </div>
      <div class="card">
        <h3>Actionable Results</h3>
        <p>Email extraction, duplicate flags, and a clear similarity score for decisions.</p>
      </div>
      <div class="card">
        <h3>Local & Private</h3>
        <p>Process files on your own machine/server—keep sensitive data in-house.</p>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="section">
    <h2>FAQ</h2>
    <div class="accordion" id="faq">
      <details class="acc-item" open>
        <summary>What files are supported?</summary>
        <div class="acc-body">PDF for both JD and resumes.</div>
      </details>
      <details class="acc-item">
        <summary>How are scores computed?</summary>
        <div class="acc-body">TF-IDF vectors + cosine similarity with term boosts (JD ×1.5, Resume ×2.0).</div>
      </details>
      <details class="acc-item">
        <summary>How are duplicates handled?</summary>
        <div class="acc-body">We hash the raw resume text; re-uploads in the same run are marked duplicates and not re-scored.</div>
      </details>
    </div>
  </section>

{% else %}
  <!-- LOGGED-IN: Dashboard hero -->
  <section class="hero hero-dashboard">
    <!-- OPTIONAL DASHBOARD IMAGE AREA -->
    <div class="hero-content">
      <h1>Welcome{{ ', ' ~ session.get('company_name') if session.get('company_name') else '' }}.</h1>
      <p class="sub">Start a new screening run or jump back into your latest results.</p>
      <div class="cta-row">
        <a class="btn btn-primary" href="{{ url_for('actual_calculation') }}">Start New Screening</a>
        {% if last_results and last_results|length %}
          <a class="btn btn-ghost" href="{{ url_for('results') }}">View Last Results</a>
        {% endif %}
      </div>
    </div>
  </section>

  <!-- Quick actions + Recent -->
  <section class="section">
    <div class="two-col">
      <div class="card">
        <h3>Quick tips</h3>
        <ul class="tips">
          <li>Upload one JD and multiple resumes in a single run.</li>
          <li>Headers like “Responsibilities” and “Qualifications” improve accuracy.</li>
          <li>Re-uploads are automatically flagged as duplicates.</li>
        </ul>
      </div>
      <div class="card">
        <h3>What’s new</h3>
        <ul class="bullet">
          <li>Refined preprocessing for better accuracy.</li>
          <li>Top-N results by similarity with duplicates last.</li>
          <li>Improved UI cards and table polish.</li>
        </ul>
      </div>
    </div>
  </section>

  {% if last_results and last_results|length %}
  <section class="section">
    <h2>Recent summary</h2>
    <div class="mini-table-wrap">
      <table class="mini-table">
        <thead>
          <tr>
            <th>S.N</th><th>Resume</th><th>Email</th><th>Duplicate</th><th>Score (0–1)</th>
          </tr>
        </thead>
        <tbody>
          {% for r in last_results[:5] %}
          <tr>
            <td>{{ r.sn }}</td>
            <td><a href="#" class="resume-link" data-filename="{{ r.name }}">{{ r.name }}</a></td>
            <td>{{ r.email or '' }}</td>
            <td>{{ r.duplicate or '—' }}</td>
            <td>{% if r.score is not none %}{{ '%.2f' % r.score }}{% else %}—{% endif %}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
  {% endif %}
{% endif %}

{% endblock %}
